# 비동기 처리의 시작 Callback

⬇️ 자바스크립트는 동기적이다. 이 말은 즉슨 자바스크립트의 코드는 `호이스팅(hoisting)`이 된 이후부터 작성한 코드의 순서에 맞춰서 하나하나씩 `동기적`으로 실행된다는 뜻이다.

앞서 배운 호이스팅은 무엇이었을까. 호이스팅은 var 변수와 함수 선언들이 자동적으로 코드의 최상단⬆️으로 올라가는 것을 의미했다!

자, 그럼 자바스크립트의 동기와 비동기 처리에 대해서 간단하게 살펴보자.

- **동기** : 동기적 처리는 정해진 순서에 맞춰서 차례대로 코드가 실행된다는 의미이며(자바스크립트 코드는 위에서 아래로 실행된다.)

```js
console.log("1"); // 1
console.log("2"); // 2
console.log("3"); // 3
```

- **비동기** : 비동기적 처리는 특정 코드의 연산이 끝날 때까지 코드의 실행을 멈추지 않고 다음 코드를 실행하는 특성을 의미한다.

## 비동기 처리의 좋은 예

좋은 예로 `setTimeout()`이 있다. setTimeout()은 Web API의 한 종류이고 해당 함수는 사용자가 지정한 시간이 지나면 전달한 콜백 함수를 호출하는 함수이다.

```js
console.log("1");
setTimeout(() => console.log("2"), 1000);
console.log("3"); // 1, 3, 2
```

**비동기적 실행**

위 코드의 실행 순서는 아래와 같다.

- 자바스크립트 엔진은 코드를 가장 위에서부터 밑으로 실행하기 때문에
  1. 첫 번째로 `1`이 출력된다.
  2. `setTimeout()`을 확인하고 이는 브라우저 API이므로 브라우저에게 요청을 보낸다.
  3. 브라우저에게 요청을 보내고 그에 대한 응답을 기다리지 않고 다음 코드로 넘어간다. (비동기적 실행)
  4. `3`이 출력되고 브라우저에서 1초의 시간이 지난 다음에 콜백 함수를 실행하라는 응답을 받는다.
  5. `2`가 출력된다.

`setTimeout()`아! 내가 전달한 함수를 지금 당장 실행하지는 말고
네가 1초가 지난 다음에 그때 내 함수를 실행해줘! 그때 나의 함수를 불러줘! Call ! 다시 불러줘! Call Back!

**내가 그의 이름을 불러주었을 때, 그는 나에게로와서 꽃이 되었다.**

즉, `setTimeout()` 내부에 인자로 전달한 함수를 **콜백 함수**라고 칭하며 이는 바로 실행되는 것이 아니라, 준비된 시점에 따라서 호출된다. 쉽게 말해서 나중에 실행되는 함수가 콜백 함수이다!

그렇다면, 콜백은 항상 비동기적인 처리에만 사용될까? 자바스크립트의 콜백 처리는 방식에 따라서 `동기`적 콜백과 `비동기`적 콜백으로 나뉜다.

- 동기적인 콜백

```js
function fakeSetTimeout(callback, delay) {
  callback();
}
console.log(0); // 0
fakeSetTimeout(function () {
  console.log("hello"); // hello
}, 0);
console.log(1); // 1
```

- 비동기적 콜백

```js
function fakeSetTimeout(callback, delay) {
  callback();
}
console.log(0); // 0
setTimeout(function () {
  console.log("hello"); // 1
}, 0);
console.log(1); // hello
```

`setTimeout()` 메서드는 자바스크립트 외부에 있는 웹 브라우저에서 제공되는 API이므로

콜백은 `"나중에 실행하라"`라고 인자로써 다른 함수에게 넘겨주지만, 그 콜백을 받은 `함수(setTimeout)`가 자기의 역할에 맞춰서 받은 콜백을 실행시킨다.

자바스크립트 내부에서 연산이 되는 것이면 위의 예시 `fakeSetTimeout`처럼 동기적으로 콜백이 실행되지만, `setTimeout()`처럼 자바스크립트 외부의 브라우저 API를 사용하는 것이면 비동기적으로 실행하게 된다.

이 말은 즉슨 비동기적인 실행은 콜스택에서 바로 실행되는 것이 아니라, 큐에서 대기하다가 콜스택으로 이동하게 되는 것인데 관련된 내용은 [이벤트 루프](https://poiemaweb.com/js-event)를 추후에 정리하면서 알아보도록 하자.

## 콜백 지옥
